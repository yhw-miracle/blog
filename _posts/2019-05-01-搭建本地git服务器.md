---
layout: post
title: 搭建本地 git 服务器
date: 2019-05-01 00:00:00 +0800
tags: [git, linux]
categories: 问题解决
author: 痛点就是起点
published: true
---

> 本文为痛点就是起点原创文章，可以随意转载，但需注明出处。

* 1.安装 git；
```bash
sudo apt-get isntall git
```
运行命令`git --version`显示 git 版本信息，即说明 git 安装成功。

* 创建 git 用户，用于运行 Git 服务；
```bash
sudo adduser git
```
这种方式创建用户默认不会设置密码，若要登录 git 用户，需要运行下面命令额外设置登录密码；
```bash
sudo passwd git
```
然后，就可以使用命令`su root`切换 git 用户登录。

```bash
sudo useradd -m git
```

```bash
sudo passwd git
```

```bash
ssh-keygen -t rsa -C 'yhw_software@qq.com' 
```

```bash
touch /home/git/.ssh/authorized_keys
```
`known_hosts`
`authorized_keys`

```bash
git init --bare demo.git  
```

```bash
sudo chown -R git:git demo.git 
```

```bash
sudo vi /ets/passwd

git:x:1001:1001::/home/git:/usr/bin/git-shell 
```

将`id_rsa.pub`文件里的公钥添加到 git 服务器`authorized_keys`里。

```bash
yhw-miracle@yhw-miracle:~$ git init --bare demo.git
yhw-miracle@yhw-miracle:~$ sudo chown -R git:git demo.git 
yhw-miracle@yhw-miracle:~$ git clone git@192.168.159.137:~/demo.git
```

```bash
sudo gpasswd -a git yhw-miracle
```
> Adding user git to group yhw-miracle

```bash
yhw-miracle@yhw-miracle:~$ git init --bare demo.git
yhw-miracle@yhw-miracle:~$ mkdir test
yhw-miracle@yhw-miracle:~$ cd test
yhw-miracle@yhw-miracle:~$ git clone git@192.168.159.137:/home/yhw-miracle/demo.git
```

- 参考
    - [搭建Git服务器](https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664)
