<html>
  <head><meta name="generator" content="Hexo 3.8.0">
    <title>Android动态自动匹配输入框 - 痛点就是起点</title>
    <link href="/images/fav.png" rel="shortcut icon">
<link href="/atom.xml" rel="alternate" type="application/rss+xml">
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/responsive.css">
<script src="/js/jquery.js"></script>
<script src="/js/basics.js"></script>
<meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type">


  </head>
  <body>
    <header>
  <a id="go-back-home" href="/"><img src="/images/logo.jpg" alt="Home" width="53" height="59"></a>
  <p>痛点就是起点</p>
  <p>Speaking is as important as doing!</p>
</header>

    <div id="container">
      <div class="block">
  
    <a class="main" href="/">Home</a>
  
    <a class="main" href="/ToYou">ToYou</a>
  
    <a class="main" href="/categories">Categories</a>
  
    <a class="main" href="/atom.xml">RSS</a>
  
</div>

      <section class="paging">
  
    <div class="left">
      <a href="/2017/12/30/2017总结/">
        ‹
      </a>
    </div>
  
  
    <div class="right">
      <a href="/2017/09/14/Android布局/">
        ›
      </a>
    </div>
  
</section>

      <div class="content">
        <section class="post">
          <h1>
            <div class="date">2017-09-16</div>
            Android动态自动匹配输入框
          </h1>
          <p>动态自动匹配输入框,可以分为单匹配和多匹配两种，如百度搜索框和邮箱发件人的输入框。</p>
<h4 id="1-单匹配-AutoCompleteTextView"><a href="#1-单匹配-AutoCompleteTextView" class="headerlink" title="1 单匹配(AutoCompleteTextView)"></a>1 单匹配(AutoCompleteTextView)</h4><ol>
<li>初始化 AutoCompleteTextView 控件</li>
<li>需要一个适配器</li>
<li>初始化数据源</li>
<li>将 adapter 与 acTextView 绑定</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AutoCompleteTextView acTextView = (AutoCompleteTextView)findViewById(R.id.AutoCompleteTextView1);</span><br><span class="line">String[] data1 = &#123;<span class="string">"Android"</span>,<span class="string">"Book"</span>,<span class="string">"system"</span>,<span class="string">"haha"</span>,<span class="string">"hehe"</span>,<span class="string">"shabi"</span>&#125;;</span><br><span class="line">ArrayAdapter&lt;String&gt; adapter1 = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>,R.layout.support_simple_spinner_dropdown_item,data1);</span><br><span class="line">acTextView.setAdapter(adapter1);</span><br></pre></td></tr></table></figure>
<h4 id="2-多匹配-MultiAutoCompleteTextView"><a href="#2-多匹配-MultiAutoCompleteTextView" class="headerlink" title="2 多匹配(MultiAutoCompleteTextView)"></a>2 多匹配(MultiAutoCompleteTextView)</h4><ol>
<li>初始化 MultiAutoCompleteTextView 控件</li>
<li>需要一个适配器</li>
<li>初始化数据源</li>
<li>将 adapter 与 acTextView 绑定</li>
<li>设置分隔符</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MultiAutoCompleteTextView macTextView = (MultiAutoCompleteTextView)findViewById(R.id.MultiAutoCompleteTextView1);</span><br><span class="line">String[] data2 = &#123;<span class="string">"123"</span>,<span class="string">"12345"</span>,<span class="string">"haharr"</span>,<span class="string">"httt,"</span>rr<span class="string">"&#125;;</span></span><br><span class="line"><span class="string">ArrayAdapter&lt;String&gt; adapter2 = new ArrayAdapter&lt;String&gt;(this,R.layout.support_simple_spinner_dropdown_item,data2);</span></span><br><span class="line"><span class="string">macTextView.setAdapter(adapter2);</span></span><br><span class="line"><span class="string">macTextView.setTokenizer(new MultiAutoCompleteTextView.CommaTokenizer());</span></span><br></pre></td></tr></table></figure>
<p>该方法只支持逗号连接，若需要自定义分隔符，需要自定义类，然后用语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macTextView.setTokenizer(<span class="keyword">new</span> SemicolonTokenizer(<span class="string">';'</span>));</span><br></pre></td></tr></table></figure>
<p>执行。自定义分隔符类的代码如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.text.SpannableString;</span><br><span class="line"><span class="keyword">import</span> android.text.Spanned;</span><br><span class="line"><span class="keyword">import</span> android.text.TextUtils;</span><br><span class="line"><span class="keyword">import</span> android.widget.MultiAutoCompleteTextView;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by yhw-miracle on 2017/9/13.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@effect</span> 自定义 MultiAutoCompleteTextView 添加分隔符</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SemicolonTokenizer</span> <span class="keyword">implements</span> <span class="title">MultiAutoCompleteTextView</span>.<span class="title">Tokenizer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">char</span> charS;</span><br><span class="line">    <span class="keyword">private</span> String mSTring;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SemicolonTokenizer</span><span class="params">(<span class="keyword">char</span> charS)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.charS = charS;</span><br><span class="line">        mSTring = String.valueOf(charS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTokenStart</span><span class="params">(CharSequence text, <span class="keyword">int</span> cursor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; text.charAt(i - <span class="number">1</span>) != charS) &#123;</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; cursor &amp;&amp; text.charAt(i) == <span class="string">' '</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findTokenEnd</span><span class="params">(CharSequence text, <span class="keyword">int</span> cursor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line">        <span class="keyword">int</span> len = text.length();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">            <span class="keyword">if</span> (text.charAt(i) == charS) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> len;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CharSequence <span class="title">terminateToken</span><span class="params">(CharSequence text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = text.length();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; text.charAt(i - <span class="number">1</span>) == <span class="string">' '</span>) &#123;</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; text.charAt(i - <span class="number">1</span>) == charS) &#123;</span><br><span class="line">            <span class="keyword">return</span> text;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (text <span class="keyword">instanceof</span> Spanned) &#123;</span><br><span class="line">                SpannableString sp = <span class="keyword">new</span> SpannableString(text + mSTring);</span><br><span class="line">                TextUtils.copySpansFrom((Spanned) text, <span class="number">0</span>, text.length(), Object.class, sp, <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">return</span> sp;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> text + mSTring;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          <br>
<p> from yhw-miracle</p>
<p align="center"><img src="/images/qrcode_for_gh_5efb2780ab44_258.jpg" alt="痛点就是起点"></p>
<p align="center">算法和代码的世界不仅是学习的痛点，而且是成功的起点。欢迎关注，共同进步！</p>

        </section>
      </div>
      
      <!--<div class="block">
  
    <a class="main" href="/">Home</a>
  
    <a class="main" href="/ToYou">ToYou</a>
  
    <a class="main" href="/categories">Categories</a>
  
    <a class="main" href="/atom.xml">RSS</a>
  
</div>
-->
    </div>
    <footer>
  <span class="muted">&copy; 2016 - 2019 yhw-miracle. All Rights Reserved.</span><br>
  <!--<a href='https://github.com/saintwinkle/hexo-theme-scribble' class='muted'>built with Hexo using Scribble theme</a>-->
  <img src="/images/logo.jpg" width="53" height="59" alt="痛点就是起点">
</footer>

  </body>
</html>
